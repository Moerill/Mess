{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/actor-item-sort-btn.js","webpack:///./src/scripts/add-scrolling.js","webpack:///./src/scripts/change-placeables.js","webpack:///./src/scripts/index.js","webpack:///./src/scripts/modify-templates.js","webpack:///./src/scripts/prepared-spell-tracker.js","webpack:///./src/scripts/settings.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","installedModules","__webpack_require__","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","p","jsonpScriptSrc","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","s","async","addAlphabeticalSorter","app","html","actor","_id","querySelectorAll","forEach","el","closest","dataset","tab","btn","innerHTML","classList","add","title","style","flex","margin","addEventListener","ev","lists","actorId","fromUuid","concatList","map","items","spells","flat","sort","a","b","siblings","sortUpdates","SortingHelpers","performIntegerSort","duplicate","sortBefore","updateData","u","update","updateEmbeddedEntity","sortItemListAlphabetically","prepend","itemSortBtn","Hooks","on","addScolling","preventDefault","stopPropagation","deltaY","currentTarget","Number","Math","max","$","change","onDragLeftMove","clones","destination","origin","originalEvent","canvas","_onDragCanvasPan","dx","x","dy","y","snap","previous","momentumThreshold","lambda","prev","prevMomentum","momentum","prevV","v","shiftKey","dest","_original","grid","getSnappedPosition","this","layer","options","gridPrecision","refresh","changePlaceables","PlaceableObject","_onDragLeftMove","game","settings","user","isGM","moduleVersion","version","register","default","String","scope","oldVersion","isNewerVersion","mess","init","changeTemplates","newFun","MeasuredTemplate","toString","replace","querySelector","Function","getTargets","isTokenInside","oldFun","ret","dndTemplateSettings","system","id","importedJS","import","AbilityTemplate","itemHook","_originalFromItem","fromItem","item","template","path","getFlag","hasDamage","damage","parts","loadTexture","then","tex","texture","activatePreviewListeners","token","scene","templatePos","startX","width","startY","height","currGrid","shape","contains","tokens","getEmbeddedCollection","targets","updateTokenTargets","div","innerText","i18n","localize","formField","inp","dtype","insertAdjacentHTML","button","_activateFilePicker","after","addPreparedSpellTracker","isNPC","tracker","border","preparedSpells","sep","val","isNaN","setFlag","constructor","alignSelf","parentNode","insertBefore","MessSettings","FormApplication","isDnD","hint","config","Boolean","set","registerMenu","label","icon","restricted","loadTemplates","super","defaultOptions","classes","tabs","navSelector","contentSelector","initial","submitOnClose","btns","_getHeaderButtons","templateTexture","templateAutoTargeting","templateDrawBordersOnlyOnHighlight","getData","dmgTypes","CONFIG","DND5E","damageTypes","templateTypes","types","getSettingsData","activateListeners","formData","expandObject","entries","Dialog","content","buttons","yes","callback","location","reload","no","render"],"mappings":"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","file":"index.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t};\n\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"index\": 0\n \t};\n\n\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"bundles/\" + ({\"welcome-screen\":\"welcome-screen\"}[chunkId]||chunkId) + \".\" + {\"welcome-screen\":\"a969\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"modules/mess/scripts/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/scripts/index.js\");\n","async function sortItemListAlphabetically(lists, actorId) {\n\tconst actor = await fromUuid(`Actor.${actorId}`);\n\tlet concatList = lists.map(e => e.items || e.spells).flat();\n\tconcatList.sort(function (a, b) {\n\t\tif (a.name < b.name) return -1;\n\t\tif (a.name > b.name) return 1;\n\t\treturn 0;\n\t});\n\tlet siblings = [concatList.shift()];\n\tlet sortUpdates = [];\n\tfor (; concatList.length > 0; siblings.push(concatList.shift())) {\n\t\tsortUpdates = (SortingHelpers.performIntegerSort(concatList[0], {\n\t\t\ttarget: siblings[siblings.length-1], \n\t\t\tsiblings: duplicate(siblings),\n\t\t\tsortBefore: false}));\t\t\n\t}\n\tconst updateData = sortUpdates.map(u => {\n\t\tlet update = u.update;\n\t\tupdate._id = u.target._id;\n\t\treturn update;\n\t})\n\tactor.updateEmbeddedEntity('OwnedItem', updateData);\n}\n\nasync function addAlphabeticalSorter(app, html, data) {\n\tif (!data.actor._id) return;\n\tconst header = html.querySelectorAll('.filter-list');\n\n\theader.forEach(el => {\n\t\tconst type = el.closest('.tab').dataset.tab;\n\t\tconst btn = document.createElement('a');\n\t\tbtn.innerHTML = '<i class=\"fas fa-sort\"></i>';\n\t\tbtn.classList.add('mess-sort-btn');\n\t\tbtn.title = `Sort ${type} alphabetically.`;\n\t\tbtn.style.flex = 0;\n\t\tbtn.style.margin = \"0 5px 0 0\";\n\t\tbtn.addEventListener('click',\t(ev) => sortItemListAlphabetically(data[type], data.actor._id))\n\t\tel.prepend(btn);\n\t});\n}\n\nexport default async function itemSortBtn() {\n\tHooks.on('renderActorSheet', (app, html, data) => {\n\t\taddAlphabeticalSorter(app, html[0], data);\n\t});\n}","export default async function addScolling() {\n\tHooks.on('renderActorSheet', async function (app,  html, data) {\n\t\thtml[0].querySelectorAll('input[data-dtype=\"Number\"], .item-uses input').forEach(el => {\n\t\t\tel.addEventListener('wheel', ev => {\n\t\t\t\tev.preventDefault();\n\t\t\t\tev.stopPropagation();\n\t\t\t\tif (ev.deltaY < 0)\n\t\t\t\t\tev.currentTarget.value = Number(ev.currentTarget.value) + 1;\n\t\t\t\tif (ev.deltaY > 0)\n\t\t\t\t\tev.currentTarget.value = Math.max(Number(ev.currentTarget.value) - 1, 0);\n\n\t\t\t\t$(ev.currentTarget).change()\n\t\t\t});\n\t\t})\n\t});\n}","function onDragLeftMove(event) {\n\tconst {clones, destination, origin, originalEvent} = event.data;\n\n\t// Pan the canvas if the drag event approaches the edge\n\tcanvas._onDragCanvasPan(originalEvent);\n\n\t// Determine dragged distance\n\tconst dx = destination.x - origin.x;\n\tconst dy = destination.y - origin.y;\n\n\tlet snap = false;\n\tif (event.data.previous) {\n\t\t// Interesting would be here how this all behaves for different monitor sizes/performances and when Atro possibly introduces more adaptive rates for mosue movement. \n\t\t// Why? Because currently i just set the timedifferences between function calls to 1. So for 60Hz it behaves same as 30Hz although for 30Hz the distance travelled could be bigger.\n\t\t// All this because i don't want divisions in here for the moment....\n\t\tconst momentumThreshold = 30;\n\t\t// smaller lambda means less \"memory\" => current momentum does have more impact\n\t\t// => more jumping around between snapping and not\n\t\t// but higher means more waiting/slow movement time for it to snap\n\t\tconst lambda = 0.8;\n\t\tconst prev = event.data.previous;\n\t\tconst prevMomentum = event.data.momentum || 0;\n\t\tconst prevV = event.data.v || {x: 0, y: 0};\n\t\tconst v = {\n\t\t\tx: destination.x - prev.x,\n\t\t\ty: destination.y - prev.y\n\t\t}\n\t\tconst momentum = {\n\t\t\tx: v.x - prevV.x,\n\t\t\ty: v.y - prevV.y\n\t\t};\n\n\t\tevent.data.momentum = (momentum.x * momentum.x + momentum.y * momentum.y) + prevMomentum * lambda;\n\t\tsnap = !event.shiftKey && event.data.momentum < momentumThreshold;\n\t}\n\n\tevent.data.previous = destination;\n\n\t// Update the position of each clone\n\tfor ( let c of clones || [] ) {\n\t\tlet dest = {x: c._original.data.x + dx, y: c._original.data.y + dy};\n\t\tif ( snap ) {\n\t\t\tdest = canvas.grid.getSnappedPosition(dest.x, dest.y, this.layer.options.gridPrecision);\n\t\t}\n\t\tc.data.x = dest.x;\n\t\tc.data.y = dest.y;\n\t\tc.refresh();\n\t}\n}\n\nexport function changePlaceables() {\n\tPlaceableObject.prototype._onDragLeftMove = onDragLeftMove;\n\t// Change got bigger than expected, so.. complete swap it is\n}","import { MessSettings } from \"./settings.js\";\nimport { dndTemplateSettings, changeTemplates } from \"./modify-templates.js\";\nimport { changePlaceables } from \"./change-placeables.js\";\nimport itemSortBtn from \"./actor-item-sort-btn.js\";\nimport preparedSpellTracker from \"./prepared-spell-tracker.js\";\nimport addScrolling from \"./add-scrolling.js\";\n\nHooks.on(\"ready\", async function () {\n  if (game.settings.get(\"mess\", \"actor-item-sort\")) itemSortBtn();\n  if (game.settings.get(\"mess\", \"prepared-spell-tracker\"))\n    preparedSpellTracker();\n  if (game.settings.get(\"mess\", \"add-scrolling\")) addScrolling();\n\n  if (!game.user.isGM) return;\n  // Edit next line to match module.\n  const module = game.modules.get(\"mess\");\n  const title = module.data.title;\n  const moduleVersion = module.data.version;\n  game.settings.register(title, \"version\", {\n    name: `${title} Version`,\n    default: \"0.0.0\",\n    type: String,\n    scope: \"world\",\n  });\n  const oldVersion = game.settings.get(title, \"version\");\n\n  if (!isNewerVersion(moduleVersion, oldVersion)) return;\n\n  (\n    await import(\n      /* webpackChunkName: \"welcome-screen\" */\n      \"./welcome-screen.js\"\n    )\n  ).default();\n});\n\nHooks.on(\"init\", function () {\n  game.mess = {};\n  MessSettings.init();\n\n  dndTemplateSettings();\n  changeTemplates();\n  if (game.settings.get(\"mess\", \"change-placeables\")) changePlaceables();\n  //\tif (game.settings.get('mess', 'better-draggable-lists'))\n  //\t\tinitDraggableLists();\n});\n","export function changeTemplates() {\n\t// #MonkeyPatchingFTW\n\t// better than stealing the code, replacing one line and then release it under a/the wrong license..\n\t// Disadvantage: could need more fixing on updates. At least i didn#t make it line based like Kakaroto.. :P\n\n\tlet newFun = MeasuredTemplate.prototype.refresh.toString();\n\n\tif (game.settings.get('mess', 'modify-templates')) {\n\t\tnewFun = newFun.replace(\n\t\t\t/this\\.template\\.beginTextureFill\\(\\{[\\s\\S]*\\}\\)\\;/,\n\t\t\t`\n\t\t\t{\n\t\t\t\tlet mat = PIXI.Matrix.IDENTITY;\n\t\t\t\t// rectangle\n\t\t\t\tif (this.shape.width && this.shape.height)\n\t\t\t\t\tmat.scale(this.shape.width / this.texture.width, this.shape.height / this.texture.height);\n\t\t\t\telse if (this.shape.radius) {\n\t\t\t\t\tmat.scale(this.shape.radius * 2 / this.texture.height, this.shape.radius * 2 / this.texture.width)\n\t\t\t\t\t// Circle center is texture start...\n\t\t\t\t\tmat.translate(-this.shape.radius, -this.shape.radius);\n\t\t\t\t} else if (this.data.t === \"ray\") {\n\t\t\t\t\tconst d = canvas.dimensions,\n\t\t\t\t\t\t\t\theight = this.data.width * d.size / d.distance,\n\t\t\t\t\t\t\t\twidth = this.data.distance * d.size / d.distance;\n\t\t\t\t\tmat.scale(width / this.texture.width, height / this.texture.height);\n\t\t\t\t\tmat.translate(0, -height * 0.5);\n\n\t\t\t\t\tmat.rotate(toRadians(this.data.direction));\n\t\t\t\t} else {// cone\n\t\t\t\t\tconst d = canvas.dimensions;\n\t\t\t\n\t\t\t\t\t// Extract and prepare data\n\t\t\t\t\tlet {direction, distance, angle} = this.data;\n\t\t\t\t\tdistance *= (d.size / d.distance);\n\t\t\t\t\tdirection = toRadians(direction);\n\t\t\t\t\tconst width = this.data.distance * d.size / d.distance;\n\n\t\t\t\t\tconst angles = [(angle/-2), (angle/2)];\n\t\t\t\t\tdistance = distance / Math.cos(toRadians(angle/2));\n\t\t\t\n\t\t\t\t\t// Get the cone shape as a polygon\n\t\t\t\t\tconst rays = angles.map(a => Ray.fromAngle(0, 0, direction + toRadians(a), distance+1));\n\t\t\t\t\tconst height = Math.sqrt((rays[0].B.x - rays[1].B.x) * (rays[0].B.x - rays[1].B.x)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ (rays[0].B.y - rays[1].B.y) * (rays[0].B.y - rays[1].B.y));\n\t\t\t\t\tmat.scale(width / this.texture.width, height / this.texture.height);\n\t\t\t\t\tmat.translate(0, -height/2)\n\t\t\t\t\tmat.rotate(toRadians(this.data.direction));\n\t\t\t\t}\n\t\t\t\tthis.template.beginTextureFill({\n\t\t\t\t\ttexture: this.texture,\n\t\t\t\t\tmatrix: mat,\n\t\t\t\t\talpha: 0.8\n\t\t\t\t});\n\t\t\t\t// move into draw or so\n\t\t\t\tconst source = getProperty(this.texture, \"baseTexture.resource.source\")\n\t\t\t\tif ( source && (source.tagName === \"VIDEO\") ) {\n\t\t\t\t\tsource.loop = true;\n\t\t\t\t\tsource.muted = true;\n\t\t\t\t\tgame.video.play(source);\n\t\t\t\t}\n\t\t}`\n\t\t);\n\n\t\tHooks.on('renderMeasuredTemplateConfig', (app, html, data) => {\n\t\t\thtml[0].querySelector('.file-picker').dataset.type = 'imagevideo';\n\t\t});\n\t}\n\n\tif (game.settings.get('mess', 'templateDrawBordersOnlyOnHighlight')) {\n\t\tnewFun = newFun.replace(\n\t\t\t/this\\.\\_borderThickness/,\n\t\t\t'this.texture && !this._hover ? 0 : this._borderThickness'\n\t\t);\n\t\tnewFun = newFun.replace(\n\t\t\t/return\\sthis\\;/,\n\t\t\t`\n\t\t\tconst grid = canvas.grid;\n\t\t\t// only show grid highlights on hover\n\t\t\tif (this.texture) {\n\t\t\t\tconst hl = grid.getHighlightLayer(\\`Template.\\$\\{this.id\\}\\`);\n\t\t\t\tif (hl)\n\t\t\t\t\thl.renderable = this._hover;\n\t\t\t}\n\t\t\treturn this;`\n\t\t);\n\t}\n\n\tMeasuredTemplate.prototype.refresh = Function(\n\t\t`\"use strict\"; return ( function ${newFun} )`\n\t)();\n\n\tif (game.settings.get('mess', 'templateAutoTargeting')) {\n\t\tMeasuredTemplate.prototype.getTargets = getTargets;\n\t\tMeasuredTemplate.prototype.isTokenInside = isTokenInside;\n\n\t\tconst oldFun = MeasuredTemplate.prototype._onDragLeftMove;\n\t\tMeasuredTemplate.prototype._onDragLeftMove = function (ev) {\n\t\t\tconst ret = oldFun.bind(this)(ev);\n\n\t\t\tfor (let c of ev.data.clones) this.getTargets(c);\n\n\t\t\treturn ret;\n\t\t};\n\t}\n}\n\nexport async function dndTemplateSettings() {\n\tif (game.system.id !== 'dnd5e') return;\n\n\tconst importedJS = await import(\n\t\t/* webpackIgnore: true */ '/systems/dnd5e/module/pixi/ability-template.js'\n\t);\n\tconst AbilityTemplate = importedJS.default || importedJS.AbilityTemplate;\n\n\t// Auto texture creation from item\n\tif (game.settings.get('mess', 'modify-templates')) {\n\t\tHooks.on('renderItemSheet', itemHook);\n\n\t\tconst _originalFromItem = AbilityTemplate.fromItem;\n\t\tAbilityTemplate.fromItem = function (item) {\n\t\t\tconst template = _originalFromItem.bind(this)(item);\n\n\t\t\t// generate a texture based on the items dmg type, ...\n\t\t\t// Add settings to define custom templates for stuff.\n\t\t\tlet path = item.getFlag('mess', 'templateTexture');\n\t\t\tif (!path && item.hasDamage) {\n\t\t\t\tconst settings = game.settings.get('mess', 'templateTexture') || {};\n\t\t\t\tpath = settings[item.data.data.damage.parts[0][1]] || {};\n\t\t\t\tpath = path[template.data.t];\n\t\t\t}\n\t\t\tif (path)\n\t\t\t\tloadTexture(path).then((tex) => {\n\t\t\t\t\ttemplate.texture = tex;\n\t\t\t\t\ttemplate.data.texture = path;\n\t\t\t\t\ttemplate.refresh();\n\t\t\t\t});\n\t\t\ttemplate.item = item;\n\t\t\treturn template;\n\t\t};\n\t}\n\n\tif (game.settings.get('mess', 'templateAutoTargeting')) {\n\t\t//  rather ugly, maybe find a better way at some point :shrug:\n\t\tconst origPrevListeners = AbilityTemplate.prototype.activatePreviewListeners.toString();\n\t\tconst newFun = origPrevListeners.replace(\n\t\t\t/this\\.refresh\\(\\)\\;/,\n\t\t\t// get targets\n\t\t\t`this.refresh();\n\t\t\t\t\t\tthis.getTargets(this);\n\t\t\t\t\t`\n\t\t);\n\n\t\tAbilityTemplate.prototype.getTargets = getTargets;\n\t\tAbilityTemplate.prototype.isTokenInside = isTokenInside;\n\n\t\tAbilityTemplate.prototype.activatePreviewListeners = Function(\n\t\t\t`\"use strict\"; return ( function ${newFun} )`\n\t\t)();\n\t}\n}\n\nfunction isTokenInside(token) {\n\tconst grid = canvas.scene.data.grid,\n\t\ttemplatePos = { x: this.data.x, y: this.data.y };\n\t// Check for center of  each square the token uses.\n\t// e.g. for large tokens all 4 squares\n\tconst startX = token.width >= 1 ? 0.5 : token.width / 2;\n\tconst startY = token.height >= 1 ? 0.5 : token.height / 2;\n\tfor (let x = startX; x < token.width; x++) {\n\t\tfor (let y = startY; y < token.height; y++) {\n\t\t\tconst currGrid = {\n\t\t\t\tx: token.x + x * grid - templatePos.x,\n\t\t\t\ty: token.y + y * grid - templatePos.y,\n\t\t\t};\n\t\t\tconst contains = this.shape.contains(currGrid.x, currGrid.y);\n\t\t\tif (contains) return true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction getTargets(template) {\n\tconst tokens = canvas.scene.getEmbeddedCollection('Token');\n\tlet targets = [];\n\n\tfor (const token of tokens)\n\t\tif (template.isTokenInside(token)) {\n\t\t\ttargets.push(token._id);\n\t\t}\n\tgame.user.updateTokenTargets(targets);\n}\n\nasync function itemHook(app, html) {\n\tconst div = document.createElement('div');\n\tdiv.classList.add('form-group');\n\tdiv.appendChild(\n\t\tdocument.createElement('label')\n\t).innerText = game.i18n.localize('MESS.itemSheet.templateTexture');\n\tconst formField = div.appendChild(document.createElement('div'));\n\tformField.classList.add('form-fields');\n\tconst inp = formField.appendChild(document.createElement('input'));\n\tinp.dataset.dtype = 'String';\n\tinp.type = 'text';\n\tinp.name = 'flags.mess.templateTexture';\n\tinp.value = app.object.getFlag('mess', 'templateTexture') || '';\n\n\tformField.insertAdjacentHTML(\n\t\t'beforeend',\n\t\t`\n\t\t<button type=\"button\" class=\"file-picker\" data-type=\"imagevideo\" data-target=\"flags.mess.templateTexture\" title=\"Browse Files\" tabindex=\"-1\">\n\t\t\t<i class=\"fas fa-file-import fa-fw\"></i>\n\t\t</button>\n\t`\n\t);\n\tconst button = formField.querySelector('button');\n\tbutton.style.flex = '0';\n\tapp._activateFilePicker(button);\n\tconst target = html[0].querySelector('[name=\"data.target.units\"]');\n\tif (target) target.closest('.form-group').after(div);\n}\n","export default async function addPreparedSpellTracker() {\n\tHooks.on('renderActorSheet', async function (app,  html, data) {\n\t\tconst actor = await fromUuid(`Actor.${data.actor._id}`);\n\t\tif (actor.isNPC) return;\n\t\t\n\t\tconst spellDc = html[0].querySelector('.spell-dc');\n\t\tif (!spellDc) return;\n\t\tlet tracker = document.createElement('div');\n\t\ttracker.classList.add('spell-detail');\n\t\ttracker.classList.add('spell-slots');\n\t\ttracker.style.flex = '1';\n\t\ttracker.style.border = 'none';\n\t\tconst spanPrep = tracker.appendChild(document.createElement('span'));\n\t\tspanPrep.innerText = `${game.i18n.localize('MESS.actorSheet.preparedSpellTracker')}: ${data.preparedSpells}`;\n\n\t\tconst sep = tracker.appendChild(document.createElement('span'));\n\t\tsep.innerText = ' / ';\n\t\tsep.classList.add('sep');\n\n\t\tconst max = tracker.appendChild(document.createElement('input'));\n\t\tmax.type = 'text';\n\t\tmax.value = actor.getFlag('mess', 'maxPreparedSpells') || 0;\n\t\tmax.addEventListener('change', async function(ev) {\n\t\t\tev.preventDefault();\n\t\t\tev.stopPropagation();\n\t\t\tconst val = Number(ev.currentTarget.value);\n\t\t\tif (isNaN(val)) {\n\t\t\t\tev.currentTarget.value = actor.getFlag('mess', 'maxPreparedSpells') || 0;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tactor.setFlag('mess', 'maxPreparedSpells', val);\n\t\t\treturn false;\n\t\t});\n\t\t\n\t\tif (app.constructor.name === 'Tidy5eSheet') {\n\t\t\tconst el = html[0].querySelector('.spellcasting-ability');\n\t\t\tif (!el)\n\t\t\t\treturn;\n\t\t\tel.appendChild(tracker, el);\n\t\t} else {\n\t\t\tconst el = html[0].querySelector('.spellbook .inventory-list');\n\t\t\tif (!el)\treturn;\n\t\t\ttracker.style.flex = '0';\n\t\t\ttracker.style.alignSelf = 'flex-start';\n\t\t\ttracker.style.margin = '0 8px';\n\t\t\tel.parentNode.insertBefore(tracker, el);\n\t\t}\n\t});\n}","export class MessSettings extends FormApplication {\n  static init() {\n    const isDnD = game.system.id === \"dnd5e\";\n\n    game.settings.register(\"mess\", \"actor-item-sort\", {\n      name: \"Activate item sort button.\",\n      hint:\n        \"Adds a button to actor sheets for sorting all items of that category alphabetically.\",\n      scope: \"world\",\n      config: false,\n      default: isDnD,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"better-draggable\", {\n      name: \"Activate better drag'n'drop workflow.\",\n      scope: \"world\",\n      config: false, // Change if implemented\n      default: isDnD,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"better-draggable-lists\", {\n      name: \"Activate better drag'n'drop workflow for lists.\",\n      scope: \"world\",\n      config: false,\n      default: true,\n      type: Boolean,\n    });\n    game.settings.set(\"mess\", \"better-draggable-lists\", false);\n\n    game.settings.register(\"mess\", \"prepared-spell-tracker\", {\n      name: \"Activate prepared spell tracker\",\n      hint:\n        \"Adds a tracker to the spellbook tab, providing a way to track the allowed maximum of prepared spells.\",\n      scope: \"world\",\n      config: false,\n      default: isDnD,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"add-scrolling\", {\n      name: \"Activating numerical field scrolling.\",\n      hint:\n        \"Lets you in-/decrease numerical fields in the Actor sheet using the mouse wheel when focused.\",\n      scope: \"world\",\n      config: false,\n      default: isDnD,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"modify-rolling\", {\n      name: \"Alternative Rolling.\",\n      hint:\n        \"Changes the way rolling is displayed and executed for DnD5e. Reload for all connected clients is required for this to take effect if changed!\",\n      scope: \"world\",\n      config: false,\n      default: isDnD,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"attack-card-always-public\", {\n      name: \"Roll mode for alternative rolling.\",\n      hint:\n        \"Always roll attack rolls public, with hidden rolls, but visible target.\",\n      scope: \"world\",\n      config: false,\n      default: isDnD,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"modify-templates\", {\n      name: \"Activate modified templates.\",\n      hint:\n        \"Makes templates texture fill scaling instead of tiling and does allow the usage of videos as texture. Reload for all connected clients is required for this to take effect if changed!\",\n      scope: \"world\",\n      config: false,\n      default: true,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"change-placeables\", {\n      name: \"Activate placeables changes.\",\n      hint:\n        \"Changes some behaviours of placeables, like preview snapping to grid. Reload for all connected clients is required for this to take effect if changed!\",\n      scope: \"world\",\n      config: false,\n      default: true,\n      type: Boolean,\n    });\n    game.settings.registerMenu(\"mess\", \"templateTexture\", {\n      name: game.i18n.localize(\"MESS.FVTTSettings.description\"),\n      label: game.i18n.localize(\"MESS.FVTTSettings.button\"),\n      icon: \"fas fa-mug-hot\",\n      type: MessSettings,\n      restricted: true,\n    });\n\n    game.settings.register(\"mess\", \"templateTexture\", {\n      name: \"Activate placeables changes.\",\n      hint:\n        \"Changes some behaviours of placeables, like preview snapping to grid. Reload for all connected clients is required for this to take effect if changed!\",\n      scope: \"world\",\n      default: true,\n      type: Object,\n    });\n\n    game.settings.register(\"mess\", \"max-critical\", {\n      name: \"Activate maximum critical rolls.\",\n      hint:\n        \"Changes behaviour of critical damage rolls to maximize the damage of the extra dice for criticals!\",\n      scope: \"world\",\n      config: false,\n      default: false,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"templateTexture\", {\n      name: \"Activate placeables changes.\",\n      hint:\n        \"Changes some behaviours of placeables, like preview snapping to grid. Reload for all connected clients is required for this to take effect if changed!\",\n      scope: \"world\",\n      config: false,\n      default: true,\n      type: Object,\n    });\n\n    game.settings.register(\"mess\", \"templateAutoTargeting\", {\n      scope: \"world\",\n      default: true,\n      type: Boolean,\n    });\n\n    game.settings.register(\"mess\", \"templateDrawBordersOnlyOnHighlight\", {\n      scope: \"world\",\n      default: true,\n      type: Boolean,\n    });\n\n    this.loadTemplates();\n  }\n  static loadTemplates() {\n    loadTemplates([\n      \"modules/mess/templates/settings/templates.html\",\n      \"modules/mess/templates/settings/dnd5e.html\",\n      \"modules/mess/templates/settings/misc.html\",\n    ]);\n  }\n\n  static get defaultOptions() {\n    return {\n      ...super.defaultOptions,\n      template: \"modules/mess/templates/settings/settings.html\",\n      height: \"auto\",\n      title: \"Mess - Moerills enhancing super-suit(e) - Settings Menu\",\n      width: 600,\n      classes: [\"mess\", \"settings\"],\n      tabs: [\n        {\n          navSelector: \".tabs\",\n          contentSelector: \"form\",\n          initial: \"name\",\n        },\n      ],\n      submitOnClose: true,\n    };\n  }\n\n  constructor(object = {}, options) {\n    super(object, options);\n    this.object = game.settings.get(\"mess\", \"templateTexture\");\n  }\n\n  _getHeaderButtons() {\n    let btns = super._getHeaderButtons();\n    btns[0].label = \"Save & Close\";\n    return btns;\n  }\n\n  getSettingsData() {\n    const isDnD = game.system.id === \"dnd5e\";\n    let data = {\n      \"modify-templates\": game.settings.get(\"mess\", \"modify-templates\"),\n      \"change-placeables\": game.settings.get(\"mess\", \"change-placeables\"),\n      templateTexture: game.settings.get(\"mess\", \"templateTexture\"),\n      templateAutoTargeting: game.settings.get(\"mess\", \"templateAutoTargeting\"),\n      templateDrawBordersOnlyOnHighlight: game.settings.get(\n        \"mess\",\n        \"templateDrawBordersOnlyOnHighlight\"\n      ),\n      \"better-draggable-lists\": game.settings.get(\n        \"mess\",\n        \"better-draggable-lists\"\n      ),\n    };\n    if (isDnD) {\n      data[\"templateTexture\"] = game.settings.get(\"mess\", \"templateTexture\");\n      data[\"modify-rolling\"] = game.settings.get(\"mess\", \"modify-rolling\");\n      data[\"max-critical\"] = game.settings.get(\"mess\", \"max-critical\");\n\n      data[\"actor-item-sort\"] = game.settings.get(\"mess\", \"actor-item-sort\");\n      // data['better-draggable'] = game.settings.get('mess', 'better-draggable');\n      data[\"prepared-spell-tracker\"] = game.settings.get(\n        \"mess\",\n        \"prepared-spell-tracker\"\n      );\n      data[\"add-scrolling\"] = game.settings.get(\"mess\", \"add-scrolling\");\n      data[\"attack-card-always-public\"] = game.settings.get(\n        \"mess\",\n        \"attack-card-always-public\"\n      );\n    }\n    return data;\n  }\n\n  getData() {\n    const isDnD = game.system.id === \"dnd5e\";\n    let data = super.getData();\n    if (isDnD) {\n      data.dmgTypes = CONFIG.DND5E.damageTypes;\n      data.templateTypes = CONFIG.MeasuredTemplate.types;\n    }\n    data.isDnD = isDnD;\n    data.settings = this.getSettingsData();\n    return data;\n  }\n\n  activateListeners(html) {\n    super.activateListeners(html);\n  }\n\n  _updateObject(ev, formData) {\n    const data = expandObject(formData);\n    for (let [key, value] of Object.entries(data)) {\n      game.settings.set(\"mess\", key, value);\n    }\n    new Dialog({\n      content: `<p>${game.i18n.localize(\"MESS.reloadReminder.text\")}</p>`,\n      buttons: {\n        yes: {\n          icon: '<i class=\"fas fa-check\"></i>',\n          label: game.i18n.localize(\"MESS.reloadReminder.yes\"),\n          callback: () => location.reload(),\n        },\n        no: {\n          icon: '<i class=\"fas fa-times\"></i>',\n          label: game.i18n.localize(\"MESS.reloadReminder.no\"),\n        },\n      },\n    }).render(true);\n    // game.settings.set('mess', 'templateTexture', mergeObject({}, formData))\n  }\n}\n"],"sourceRoot":""}